<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.min.css">
    <title>RPG Dice Roller</title>
    <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet">
    <link href="https://unpkg.com/nes.css@latest/css/nes.min.css" rel="stylesheet" />
    <link href="https://unpkg.com/nes.icons@3.0.0-beta.3/css/nes-icons.min.css" rel="stylesheet">
    <style>
        html, body, pre, code, kbd, samp {
            font-family: "Press Start 2P", cursive;
        }

        body {
            background-color: #f0f0f0;
            color: #333;
            text-align: center;
            padding: 20px;
        }

        .title {
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        #dice-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }

        #controls {
            margin: 10px 0;
        }

        #roll-result {
            margin-top: 20px;
        }

        .nes-balloon {
            margin-top: 20px;
        }

        .nes-btn {
            margin: 5px;
        }
        @keyframes roll-animation {
        0% { transform: rotate(0deg); }
        25% { transform: rotate(90deg); }
        50% { transform: rotate(180deg); }
        75% { transform: rotate(270deg); }
        100% { transform: rotate(360deg); }
    }

    .rolling {
        animation: roll-animation 1s ease-in-out;
    }
    </style>
</head>

<body>
    <h1 class="nes-container with-title is-centered">RPG DICE ROLLER</h1>
    <div class="nes-container with-title is-centered">
        <p class="title">Welcome to the RPG Dice Roller</p>
        <div class="nes-container with-title is-centered" style="margin: 5%;">
            <p class="title">Have a great time Using this App</p>
            <p>Use the arrows to find the dice you want.</p>
            <p>Press + to add it to your list of dice. </p>
            <p>Press - to remove it from your list of dice. </p>
            <p>Press <i class="nes-icon is-small ban"></i> to clear your list of dice. </p>
            <p>Press <i class="nes-icon is-small check"></i> to roll your dice. </p>
            <p> Have fun! </p>
        </div>
        <div id="dice-container" class="nes-container with-title is-centered">
            <div class="nes-container is-centered"
                style="display: flex; align-items: center; justify-content: center; flex-direction: column;">
                <div id="dice-select" class="nes-container is-centered"
                    style="display: flex; align-items: center; justify-content: center;">
                    <button id="prev-dice" class="nes-btn"><i class="nes-icon caret-left"></i></button>
                    <div id="dice" class="nes-container is-light dice-icon" style="margin: 0 10px;"><i
                            class="nes-icon is-medium heart"></i></div>
                    <button id="next-dice" class="nes-btn"><i class="nes-icon caret-right"></i></button>
                </div>
                <div id="dice-selection" class="nes-container is-centered" style="margin-top: 20px;">
                </div>
            </div>
        </div>
        <div id="controls">
            <button id="add-dice" class="nes-btn is-primary">+</button>
            <button id="remove-dice" class="nes-btn is-primary">-</button>
        </div>
        <div id="controls">
            <button id="clear-dice" class="nes-btn is-error"><i class="nes-icon is-medium ban"></i></button>
            <button id="roll-dice" class="nes-btn is-success"><i class="nes-icon is-medium check"></i></button>
        </div>
        <div id="roll-result" class="lists">
            <ul class="nes-list is-disc" id="roll-list"></ul>
        </div>

        <div class="nes-balloon from-left">
            <p>Thank you for using this</p>
            <p><i class="nes-icon github-square"></i> <a href="https://github.com/kawaii-kitsune" target="_blank"
                    rel="noopener noreferrer">@kawaii-kitsune</a></p>
        </div>
    </div>

    <script>
        const diceList = ["D4", "D6", "D8", "D10", "D12", "D20"];
        const imagePaths = { "D4": "/public/skoll/d4.svg", "D6": "/public/delapouite/perspective-dice-six.svg", "D8": "/public/delapouite/dice-eight-faces-eight.svg", "D10": "/public/skoll/d10.svg", "D12": "/public/skoll/d12.svg", "D20": "/public/delapouite/dice-twenty-faces-twenty.svg" };
        let selectedDiceIndex = 0;
        let selectedDice = [];
        let rolls = [];

        const diceElement = document.getElementById("dice");
        const selectedDiceElement = document.getElementById("dice-selection");
        const rollResultElement = document.getElementById("roll-list");

        function updateDiceDisplay() {
            diceElement.innerHTML = `<img src="${imagePaths[diceList[selectedDiceIndex]]}" alt="${diceList[selectedDiceIndex]}" style="width: 50px; height: 50px;">`;
        }

        function updateSelectedDiceDisplay() {
            selectedDiceElement.innerHTML = "";
            selectedDice.forEach(dice => {
                const img = document.createElement("img");
                img.src = imagePaths[dice];
                img.alt = dice;
                img.style.width = "100px";
                img.style.height = "100px";
                selectedDiceElement.appendChild(img);
            });
        }

        function rollDice() {
            if (selectedDice.length === 0) {
            alert("Please add dice to roll.");
            return;
            }

            // Add rolling animation to each selected dice
            const diceImages = selectedDiceElement.querySelectorAll("img");
            diceImages.forEach(img => img.classList.add("rolling"));

            setTimeout(() => {
            diceImages.forEach(img => img.classList.remove("rolling"));

            rolls = [];
            selectedDice.forEach(diceType => {
                const rollResult = Math.floor(Math.random() * parseInt(diceType.slice(1)) + 1);
                rolls.push(rollResult);
            });
            displayRollResults();
            }, 1000); // Match the duration of the animation
        }

        function displayRollResults() {
            rollResultElement.textContent = "Roll Results:";

            rolls.forEach((roll, index) => {
            var li = document.createElement('li');
            li.innerHTML = `<img src="${imagePaths[selectedDice[index]]}" alt="${selectedDice[index]}" style="width: 50px; height: 50px;"> ${selectedDice[index]}: ${roll}`;
            rollResultElement.appendChild(li);
            });

            const totalSum = rolls.reduce((acc, curr) => acc + curr, 0);
            var liSum = document.createElement('li');
            liSum.textContent = `Total Sum: ${totalSum}`;
            rollResultElement.appendChild(liSum);
        }

        document.getElementById("add-dice").addEventListener("click", function () {
            if (selectedDice.length < 20) {  // Set the maximum limit to 20 dice
                selectedDice.push(diceList[selectedDiceIndex]);
                updateSelectedDiceDisplay();
            }
        });

        document.getElementById("remove-dice").addEventListener("click", function () {
            if (selectedDice.length > 0) {
                selectedDice.pop();
                updateSelectedDiceDisplay();
            }
        });

        document.getElementById("clear-dice").addEventListener("click", function () {
            selectedDice = [];
            rollResultElement.textContent = "";
            updateSelectedDiceDisplay();
        });

        document.getElementById("roll-dice").addEventListener("click", function () {
            rollDice();
        });

        document.getElementById("prev-dice").addEventListener("click", function () {
            if (selectedDiceIndex > 0) {
                selectedDiceIndex--;
                updateDiceDisplay();
                updateSelectedDiceDisplay();
            }
        });

        document.getElementById("next-dice").addEventListener("click", function () {
            if (selectedDiceIndex < diceList.length - 1) {
                selectedDiceIndex++;
                updateDiceDisplay();
                updateSelectedDiceDisplay();
            }
        });

        // Initial display update
        updateDiceDisplay();
    </script>

    <script src="script.min.js"></script>
</body>

</html>
